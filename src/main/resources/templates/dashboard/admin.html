<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Tableau de Bord - Administrateur</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid mt-4">
        <!-- Navigation Admin -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
            <div class="navbar-nav">
                <a class="nav-link" th:href="@{/}">🏠 Accueil</a>
                <a class="nav-link" th:href="@{/patients}">👥 Patients</a>
                <a class="nav-link" th:href="@{/medecins}">👨‍⚕️ Médecins</a>
                <a class="nav-link" th:href="@{/rendezvous}">📅 Rendez-vous</a>
                <a class="nav-link" th:href="@{/dashboard/edit}">✏️ Mon Profil</a>
                <form th:action="@{/logout}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-link nav-link p-0 border-0">🚪 Déconnexion</button>
                </form>
            </div>
        </nav>

        <!-- En-tête -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card bg-primary text-white text-center py-4">
                    <div class="card-body">
                        <h1 class="display-6">👑 Tableau de Bord Administrateur</h1>
                        <p class="lead mb-0">Bienvenue, <span th:text="${user.username}"></span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistiques -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="card bg-success text-white text-center">
                    <div class="card-body">
                        <h3 th:text="${#lists.size(rendezvous)}">0</h3>
                        <p class="mb-0">📅 RDV Total</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card bg-info text-white text-center">
                    <div class="card-body">
                        <h3>👥</h3>
                        <p class="mb-0">Patients</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card bg-warning text-white text-center">
                    <div class="card-body">
                        <h3>👨‍⚕️</h3>
                        <p class="mb-0">Médecins</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card bg-danger text-white text-center">
                    <div class="card-body">
                        <h3>⚡</h3>
                        <p class="mb-0">Actions</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions Rapides -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5>⚡ Actions Rapides</h5>
                    </div>
                    <div class="card-body">
                        <a th:href="@{/patients}" class="btn btn-primary me-2">👥 Voir tous les patients</a>
                        <a th:href="@{/medecins}" class="btn btn-primary me-2">👨‍⚕️ Voir tous les médecins</a>
                        <a th:href="@{/rendezvous}" class="btn btn-primary me-2">📅 Voir tous les RDV</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Liste des RDV -->
        <div class="card">
            <div class="card-header">
                <h5>📅 Derniers Rendez-vous</h5>
            </div>
            <div class="card-body">
                <div th:if="${#lists.isEmpty(rendezvous)}" class="alert alert-info text-center">
                    <h5>📭 Aucun rendez-vous</h5>
                    <p>Aucun rendez-vous n'a été pris pour le moment.</p>
                </div>

                <div th:unless="${#lists.isEmpty(rendezvous)}" class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Patient</th>
                                <th>Médecin</th>
                                <th>Date</th>
                                <th>Statut</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="rdv : ${rendezvous}">
                                <td th:text="${rdv.patient.nom + ' ' + rdv.patient.prenom}"></td>
                                <td th:text="${rdv.medecin.nom + ' ' + rdv.medecin.prenom}"></td>
                                <td th:text="${#temporals.format(rdv.dateHeure, 'dd/MM/yyyy HH:mm')}"></td>
                                <td>
                                    <span th:class="${'badge bg-' + (rdv.statut == 'CONFIRME' ? 'success' : rdv.statut == 'ANNULE' ? 'danger' : 'warning')}"
                                          th:text="${rdv.statut}"></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html>